{%extends 'core/base.html' %} {% block content %}
<div class="container">
  <div class="row mt-5">
    <div class="col-md-5 col-sm-6 border-bottom">
      <a href="{% url 'post-list' %}" class="btn btn-light">Back to Feed</a>
    </div>
  </div>


  <div class="row justify-content-center mt-5">
    <div class="card shadow-sm col-md-8 col-sm-12 border-bottom px-5 pt-3">
        <img src="{{ profile.picture.url }}" alt="" class="rounded-circle" width="100" height="100"/>


       
       {% if profile.name %}
       <h3 class="py-4">{{profile.name}}
        <span>
          {% if request.user == user %}
          <a href="{% url 'profile-edit' profile.pk %}" class="btn btn-primary">Edit Profile</a>
          {% if profile.user == request.user %}
    <a href="" class="btn btn-primary">Add Post</a>
    {% endif %}
          {% endif %}
        </span>
      </h3>
       {% else %}
       <h3 class="py-4">{{user.username}}
        <span>
          {% if request.user == user %}
          <a href="{% url 'profile-edit' profile.pk %}" class="btn btn-primary">Edit Profile</a>
          {% endif %}
        </span>
      </h3>
       {% endif %}

        

        {% if profile.location %}
        <p>{{profile.location}}</p>
        {% endif %}

        {% if profile.birth_date %}
        <p>{{profile.birth_date}}</p>
        {% endif %}

        {% if profile.bio %}
        <p>{{profile.bio}}</p>
        {% endif %}
        

        <div class="mb-3">
          <a href="{% url 'followers-list' profile.pk %}" class="post-link">Followers: {{len_followers}}</a>
          {% if user == request.user %}
          {% else %}
          {% if is_following %}
          <form method="POST" action="{% url 'remove-follower' profile.pk%}">
            {% csrf_token %}
            <button class="btn btn-outline-danger" type="submit">
              Unfollow
            </button>
          {% else %}
            <form method="POST" action="{% url 'add-follower' profile.pk%}">
              {% csrf_token %}
              <button class="btn btn-outline-success btn-outline-success" type="submit">
                Follow
              </button>
          </form>
          {% endif %}
          {% endif %}
        </div>
    </div>
    

    
  </div>




  {% for post in posts%}
  <div class="row justify-content-center mt-3">
    <div class="card" style="width: 30rem;padding-top: 1rem;">
      <a href="{% url 'profile' post.author.profile.pk %}" class="text-primary" style="text-decoration: none;margin-bottom: 1rem;">@{{post.author}}</a>
      {% if post.image %}
      <img src="{{ post.image.url }}" alt="" class="post-image" style="max-width: 100%; height: auto;">
      {% endif %}
      <div class="card-body">
        <h5 class="card-title"><b>{{post.author.username}}</b> <small>{{post.body}}</small></h5>
        <div class="d-flex flex-row">

          <form method="POST" action="{% url 'like' post.pk %}">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ request.path }}">
            <button style="background-color: transparent;border: none;box-shadow: none;" type="submit">
              <i class='bx bx-like like-icon' ></i>
            </button>
            <span>{{post.likes.all.count}}</span>
          </form>
          
          
          <form method="POST" action="{% url 'dislike' post.pk %}">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ request.path }}">
            <button style="background-color: transparent;border: none;box-shadow: none;" type="submit">
              <i class='bx bx-dislike like-icon' ></i>
              <span>{{post.dislikes.all.count}}</span>
            </button>
          </form>
    
        </div>
        <a href="{% url 'post-detail' post.pk %}"><i class='bx bx-comment'></i></a>

        <small>Created on - {{post.created_on}}</small>
      </div>
    </div>
  </div>
  {%endfor%} {% endblock %}
</div>
